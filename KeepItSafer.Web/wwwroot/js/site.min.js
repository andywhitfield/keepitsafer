function initialisePasswordGroups(){groups={};groups.groupsSection=$("#PasswordGroups");$("section",groups.groupsSection).children("article").hide();$(".group-section div",groups.groupsSection).click(toggleShowHideGroupItems);$('.password-list input[type="text"]').click(decryptPassword);$(".password-list li").click(hideDecryptedPassword);$("#modal-background, #modal-close, #modal-content input[value='Cancel']").click(function(){closeModalDialog()});$(document).keydown(function(n){n.keyCode===27&&closeModalDialog()});$("#masterpasswordentry").submit(decryptPasswordUsingMasterPassword)}function closeModalDialog(){console.log("hiding any current modal dialog");$("#modal-content, #modal-background").removeClass("active");$(".modal-content-value").hide()}function showModalDialog(n,t){closeModalDialog();console.log("showing dialog: "+n);$("#modal-content, #modal-background").addClass("active");var i=$(n);i.show();t!=undefined&&t(i)}function toggleShowHideGroupItems(){var n=$(this);console.log("group clicked: "+n.parent().attr("id"));n.next().toggle();$(window).scrollTop(n.position().top)}function hideDecryptedPassword(){var n=$('input[type="text"]',$(this));if(n.attr("data-type")=="encrypted"&&n.attr("data-decrypted")=="true"){console.log("password decrypted, reverting back to ****.");n.val("****");n.attr("data-decrypted","false");return}}function decryptPassword(){var n=$(this);if(n.attr("data-type")!="encrypted"||n.attr("data-decrypted")=="true")return console.log("password not encrypted or already decrypted, nothing to do."),n.select(),!1;var r=n.parents("li"),t=r.attr("id"),i=r.parents("section").attr("id");console.log("password clicked: "+t+" in group "+i);$.post("/api/decrypt",{group:i,entry:t}).done(function(r){if(console.log("received decrypt: "+r.decrypted+":"+r.decryptedValue+":"+r.reason),r.decrypted){n.val(r.decryptedValue);n.attr("data-decrypted","true");n.select();return}r.reason==0&&showModalDialog("#modal-content-master-password-prompt",function(n){$("input[name=group]",n).val(i);$("input[name=entry]",n).val(t);$(":password",n).val("");$(":password",n).focus()})}).fail(function(){console.log("decrypt api call failed")})}function decryptPasswordUsingMasterPassword(n){var t=$("#modal-content-master-password-prompt"),r=$("input[name=group]",t).val(),u=$("input[name=entry]",t).val(),i=$("input[name=masterpassword]",t),f=i.val();return i.val(""),console.log("submit decrypt request with form details: group="+r+";entry="+u+";masterpw="+f),closeModalDialog(),n.preventDefault(),!1}var groups;